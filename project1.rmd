---
title: "Project 1"
author: "James Eapen"
date: "2021 Oct 4"
output: 
    html_document: 
        theme: sandstone
        highlight: espresso
---

## Assignment tracker {.tabset}

[source](https://github.com/jamespeapen/expdesign/blob/gh-pages/project1.rmd)

### Setup

```{r setup, message=FALSE}
library("tidyverse")
library("lubridate")
library("ggplot2")
library("RColorBrewer")
```

### Data loading

```{r data_loading, message=FALSE}
sheets_url <- "https://docs.google.com/spreadsheets/d/1bJw_ad0PLQmLe4RvmRzsVnrOF-9Z9Xth9GTSdwO8B4M"
googlesheets4::gs4_deauth()
raw_data <- googlesheets4::read_sheet(sheets_url)

# rename columns
colnames(raw_data)  <- c("timestamp",
                      "ID",
                      "assignment",
                      "start_time",
                      "end_time",
                      "comments")
```

### Cleanup {.tabset}

#### IDs

Find out how many IDs there are with counts.

```{r}
table(raw_data$ID) %>% knitr::kable()
```

FooBarBazQux is Tim so I'll remove that row of data.

```{r}
raw_data %>% filter(ID != "FooBarBazQux") -> raw_data
```

T-rex has two IDs so replace "T-Rex" with "T-rex" to be consistent.

```{r}
# piped object can be accessed with .
raw_data$ID %>% replace(. == "T-Rex", "T-rex") -> raw_data$ID
table(raw_data$ID) %>% knitr::kable()
```


#### Assignments


### Data exploration {.tabset}

#### Datatable

```{r duration, message=FALSE}
# get durations
raw_data %>% mutate(duration = as.numeric(end_time - start_time)) -> assignments
DT::datatable(assignments)
```

#### Number of assignments done per person

```{r exploration}
assignments %>%
    ggplot(aes(x = forcats::fct_infreq(ID))) + # forcats::fct_infreq sorts the IDs by count
    geom_bar(stat = "count") +
    xlab("ID") + theme(axis.text.x = element_text(angle = 45, vjust = 0.5))
```

#### Time taken per person

```{r time_person, fig.width=10}
# filter for durations > 0 since the duration calc got negatives
nonz_durations <- assignments %>% subset(duration > 0)
nonz_durations %>%
    ggplot(aes(x = reorder(ID, duration), y = duration)) +
    geom_boxplot() +
    geom_jitter(aes(color = assignment)) +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5),
          legend.position = "bottom") +
    coord_flip()
```

#### Time taken per assignment

```{r time_assignment, fig.width=14, fig.height=14}
nonz_durations %>%
    ggplot(aes(x = reorder(assignment, duration), y = duration)) +
    geom_boxplot() +
    geom_jitter(aes(color = ID)) +
    theme(axis.text.x = element_text(angle = 90),
          legend.position = "bottom",
          axis.text.y = element_text(size = 12)) +
    coord_flip()
```

### Session Info

```{r}
sessionInfo()
```

